---
title: Troubleshooting and FAQs
---

## Why is my feature flag not working as expected?

Here's a list of suggestions to troubleshoot your flag:

### 1. Check your flag evaluation on the feature flags tab

Check the **feature flags tab** on [the persons page](https://app.posthog.com/persons) for your specific person.

![Persons feature flag tab](../../images/docs/feature-flags/persons-feature-flag-tab.png)

- If the flag is shown as disabled here, check the "match evaluation" column to know the understand why.
- If the flag is shown as enabled here, there may be a problem in your code. Double-check the steps to [add feature flag code](/docs/feature-flags/adding-feature-flag-code).

### 2. Check you're calling `identify()` before fetching the flag

If you're [identifying]((/docs/product-analytics/identify)) users, they may see a different value for a feature flag before and after you call `identify()`. 

Thus to ensure they experience consistent behavior, ensure you call `identify()` before fetching the feature flag.

### 3. An ad-blocker may be blocking calls

Check if an ad-blocker is interfering with PostHog calls. If this is the case, you can fix this by [deploying a reverse proxy](/docs/advanced/proxy).

### 4. User or group properties may not have been ingested yet

If your [release conditions](/docs/feature-flags/creating-feature-flags#release-conditions) depend on user or group properties, and you immediately fetch the feature flag after updating any of these properties, the properties may not be ingested in time to calculate the correct flag value.

In this case, when making your `getFeatureFlag()` call, you can [manually include in these properties](/docs/feature-flags/adding-feature-flag-code#advanced-overriding-server-properties) in the method arguments.

### 5. Raise a support ticket

If none of the above steps resolve your issue, you can [raise a support ticket](https://app.posthog.com/home#supportModal) to see if we can help debug.

import FAQFalseOrNoneEvents from "./snippets/faq-false-or-none-events.mdx"

<FAQFalseOrNoneEvents />

## How can I reduce the latency of feature flag requests on my server?

Evaluating feature flags requires making a request to PostHog. However, you can [evaluating feature flags locally](/docs/feature-flags/bootstrapping-and-local-evaluation#server-side-local-evaluation) instead â€“ without having to make a request to PostHog.

## How can I reduce the cost of feature flags?

If your feature flag usage or costs are too high, there a few methods to reduce them:

### 1. Reduce client-side feature flag requests

In our [JavaScript web](/docs/libraries/js) and [React Native](/docs/libraries/react-native) SDKs, you can reduce the cost of feature flags by reducing the number of requests your client makes to fetch feature flag values for your users.

Feature flags can get expensive if your code sends feature flag requests for each person.

If this is happening on the client side, i.e. while using the `posthog-js` SDK, you have two options:

1. Using the the [advanced configuration](/docs/libraries/js#advanced-configuration), set the `advanced_disable_feature_flags_on_first_load` setting to `true`. This stops automatically requesting feature flags whenever a page loads. This is useful when you're immediately calling `posthog.identify()` anyway, which requests flags again.

2. As per the [advanced configuration](/docs/libraries/js#advanced-configuration), set the `advanced_disable_feature_flags` setting to `true`. This stops automatically requesting feature flags. Instead, use the [bootstrap option](/docs/libraries/js#bootstrapping-flags) to load flags only once, via (server-side evaluation)[/docs/feature-flags/bootstrapping-and-local-evaluation#server-side-local-evaluation], which makes no requests for flags from the client side.

### 2. Reduce local evaluation costs

If you're using [local evaluation](/docs/feature-flags/local-evaluation), your bill may be high because of too many requests to fetch feature flag definitions. By default, PostHog fetches these every 30 seconds.

Each request charges 10 credits, so assuming your server is constantly running and making 2 requests per minute, this will charge `10 * 2 * 60 * 24 * 30 = 864,000 credits` each month.

You can reduce this by increasing the [feature flag polling interval](/docs/feature-flags/local-evaluation#step-2-initialize-posthog-with-your-personal-api-key) when initializing PostHog. For example, every 5 minutes instead of every 30 seconds.

The drawback of this approach is that whenever you make an update to a feature flag using the PostHog UI, it takes 5 minutes (instead of 30) for that change to roll to your server.

> **Note:** Do not use local evaluation in an edge / lambda environment, as this initializes a PostHog instance on every call, which can raise your bill drastically. It's best to use regular flag evaluation instead.

### 3. Disable sending `Feature flag called` events

By default, when you fetch a feature flag using our SDKs, PostHog will also capture a `Feature flag called` event. This enables PostHog to accurately track usage of the flag in your analytics.

It's possible to disable sending `Feature flag called` event and thus reduce your feature flag costs. To do this, set `send_events = false` when calling `isFeatureEnabled()` or `getFeatureFlag()`. The code below shows how to do this in our various SDKs:

<MultiLanguage>

```js-web
posthog.getFeatureFlag('flag-key',{
    send_event: false
})
```

```node
await posthog.getFeatureFlag('flag-key',{
    send_event: false
})
```

```python
enabled_variant = posthog.get_feature_flag('flag-key', 
    'distinct_id_of_your_user',
    send_feature_flag_events=False
    )
```

```php
$isMyFlagEnabledForUser = PostHog::isFeatureEnabled(
    'flag-key', 
    'distinct_id_of_your_user',
    [], // Optional. $groups
    [], // Optional. $personProperties
    [], // Optional. $groupProperties
    false, // Optional. $onlyEvaluateLocally
    false // Required. Set $sendFeatureFlagEvents to false to disable sending "feature flag called" events
);
```

```ruby
enabled_variant = posthog.get_feature_flag(
    'flag-key', 
    'distinct_id_of_your_user',
    send_feature_flag_events: false
)
```

```go
enabledVariant, err := client.GetFeatureFlag(
            FeatureFlagPayload{
                Key:        "flag-key",
                DistinctId: "distinct_id_of_your_user",
                SendFeatureFlagEvents: BoolPtr(false),
            })

if enabledVariant == "variant-key" { // replace 'variant-key' with the key of your variant
    // Do something differently for this user
}
```

```react-native
posthog.getFeatureFlag('flag-key',{
    send_event: false
})
```

```ios
posthog.getFeatureFlag('my-flag', options:["send_event": false])
```

```android
PostHog.with(this).getFeatureFlag(
    "flag-key",
    null, // Optional. Default value
    new HashMap<String, Object>() {{
        put("send_event", true);
}});
```

</MultiLanguage>


**Note:** This has a few consequences:

1. The feature flag's usage tab in PostHog will stop showing events, since we can't track them anymore.
2. [Experiments](/docs/experiments) that depend on [trend goals](/docs/experiments/creating-an-experiment#experiment-goal) won't work since we use this event to calculate relative exposures Convert your trend goals to funnel goals instead.


## Why do feature flags sometimes cause my app to flicker?

By default, fetching flags from our servers takes about 100-500ms. During this time, the flag is disabled. When the request is complete, the flag is updated. This may be the cause of the flickering.

To fix this, you can [bootstrap feature flags](/docs/feature-flags/bootstrapping).

## Why can't I use a cohort with behavioral filters in my feature flag?

Behavioral cohorts are [dynamic cohorts](/docs/data/cohorts#dynamic-cohorts) created using an event or action filter (i.e., the options under the "behavioral" subheading)

![Behavioral cohorts](../../images/docs/feature-flags/behavioral-cohorts.png)
<Caption>
Behavioral cohorts are dynamic cohorts created using the options under the "behavioral" subheading.
</Caption>

Feature flags require fast evaluation and behavioral queries are relatively slow. Thus enabling these queries would significantly impact the performance of feature flags. 

A workaround is to create a dynamic behavioral cohort and then duplicate it as a static cohort (using the button on the top right of the cohort page).

![How to duplicate as static cohort](../../images/docs/feature-flags/duplicate-as-static-cohort.png)

